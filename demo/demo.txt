package stepDefinition;
import io.cucumber.java.en.Given;
import io.cucumber.java.en.Then;
import io.cucumber.java.en.When;
import io.restassured.response.*;
import org.testng.Assert;
import io.cucumber.java.en.*;
import io.restassured.RestAssured;
import io.restassured.response.Response;
import io.restassured.specification.RequestSpecification;


public class StepDefinition {
	RequestSpecification reqspec;
	Response response;
	RequestSpecification req;
	Response res;
	
	@Given("visiting the API")
	public void visiting_the_api() {
		RestAssured.baseURI = "https://ergast.com/api/f1/2017/circuits.json";
		reqspec = RestAssured.given();		
	}

	@When("get response from API")
	public void get_response_from_api() {
		response = reqspec.get();
	}

	@Then("validate the response code")
	public void validate_the_response_code() {
		Assert.assertEquals(200 , response.statusCode());
	}

	@Then("verify series")
	public void verify_series() {
		String  b ="f1";
		Assert.assertEquals(b, response.jsonPath().get("MRData.series"));		
	}
	@Given("visiting the API2")
	public void visiting_the_api2() {
		RestAssured.baseURI = "https://ergast.com/api/f1/2017/circuits.json";
		reqspec = RestAssured.given();		
	}

	@When("get response from API2")
	public void get_response_from_api2() {
		response = reqspec.get();
	}

	@Then("validate the response code2")
	public void validate_the_response_code2() {
		Assert.assertEquals(200 , response.statusCode());
	}

@Then("verify circuitID")
public void verify_circuit_id() {
	String ExcircuitId = "albert_park";
	Assert.assertEquals(ExcircuitId, response.jsonPath().getString("MRData.CircuitTable.Circuits[0].circuitId"));
}

@Then("verify the circuitName")
public void verify_the_circuit_name() {
	String ExcircuitName = "Albert Park Grand Prix Circuit";
	Assert.assertEquals(ExcircuitName,response.jsonPath().getString("MRData.CircuitTable.Circuits[0].circuitName"));	
}

@Then("verify the locality")
public void verify_the_locality() {
	String Exlocality = "Melbourne";
	Assert.assertEquals(Exlocality,response.jsonPath().getString("MRData.CircuitTable.Circuits[0].Location.locality"));		 
}
@Given("visiting the API3")
public void visiting_the_api3() {
	RestAssured.baseURI = "https://ergast.com/api/f1/2017/circuits.json";
	reqspec = RestAssured.given();		
}

@When("get response from API3")
public void get_response_from_api3() {
	response = reqspec.get();
}

@Then("validate the response code3")
public void validate_the_response_code3() {
	Assert.assertEquals(200 , response.statusCode());
}
@Then("verify url")
public void verify_url() {
    String a = "http://ergast.com/api/f1/2017/circuits.json";
    Assert.assertEquals(a, response.jsonPath().getString("MRData.url"));
}

@Then("verify season")
public void verify_season() {
	String b = "2017";
	Assert.assertEquals(b, response.jsonPath().getString("MRData.CircuitTable.season"));
}
@Given("visiting the API4")
public void visiting_the_api4() {
	RestAssured.baseURI = "https://ergast.com/api/f1/2017/circuits.json";
	reqspec = RestAssured.given();		
}

@When("get response from API4")
public void get_response_from_api4() {
	response = reqspec.get();
}

@Then("validate the response code4")
public void validate_the_response_code4() {
	Assert.assertEquals(200 , response.statusCode());
}
@Then("print the responce in console")
public void print_the_responce_in_console() {
   response.prettyPrint();
}

@Given("visiting the targeted API {string}  {string}")
public void visiting_the_targeted_api(String url, String target) {
    // Write code here that turns the phrase above into concrete actions
    RestAssured.baseURI = url+ target;
	req = RestAssured.given();
}

@When("get targeted response from API")
public void get_targeted_response_from_api() {
    res = req.get();
}

@Then("print the targeted responce in console")
public void print_the_targeted_responce_in_console() { 
	res.prettyPrint();
}
}






Feature: Verify the API for practise

Scenario: verify first name and last name
Given visiting the API
When get response from API
Then validate the response code
Then verify series

Scenario: verify circuitID and circuitName and locality
Given visiting the API2
When get response from API2
Then validate the response code2
Then verify circuitID
And verify the circuitName
Then verify the locality

Scenario: verify url and season
Given visiting the API3
When get response from API3
Then validate the response code3
And verify url
Then verify season

Scenario: print the responce
Given visiting the API4
When get response from API4
Then print the responce in console

Scenario: print targeted API response using examples
Given visiting the targeted API "<url>"  "<target>"
When get targeted response from API
Then print the targeted responce in console
Examples: 
|url| target |
|https://ergast.com/api/f1/2017/circuits| /americas| 



